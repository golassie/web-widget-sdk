<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>MX Web Widget SDK UMD Integration Test</title>

    <script
      src="https://unpkg.com/@mxenabled/web-widget-sdk@0.0.3/dist/umd/index.min.js"
      integrity="sha384-uhHDrkG77LXNS/+7BaxWyXdz1fqinSJ7KvICzCjZzJC43MgkEPJFTlLXl+l8S2zf"
      crossorigin="anonymous"
    ></script>

    <script>
      document.addEventListener(
        "DOMContentLoaded",
        function () {
          const show = (id, obj) => {
            const output = document.querySelector("#output")
            if (!output) {
              throw new Error("#output element was not found")
            }

            const entry = document.createElement("div")
            entry.setAttribute("data-log-id", id)
            entry.textContent = JSON.stringify(obj)
            output.appendChild(entry)
          }

          const widget = new widgetSdk.ConnectWidget({
            widgetContainer: "#widget",
            proxy: "/get-sso-url",
            style: {
              height: "600px",
              width: "400px",
            },
            onConnectedPrimaryAction: (payload) => show("onConnectedPrimaryAction", payload),
            onCreateMemberError: (payload) => show("onCreateMemberError", payload),
            onEnterCredentials: (payload) => show("onEnterCredentials", payload),
            onFocustrap: (payload) => show("onFocustrap", payload),
            onInstitutionSearch: (payload) => show("onInstitutionSearch", payload),
            onLoad: (payload) => show("onLoad", payload),
            onLoaded: (payload) => show("onLoaded", payload),
            onMemberConnected: (payload) => show("onMemberConnected", payload),
            onMemberDeleted: (payload) => show("onMemberDeleted", payload),
            onMemberStatusUpdate: (payload) => show("onMemberStatusUpdate", payload),
            onOauthError: (payload) => show("onOauthError", payload),
            onOauthRequested: (payload) => show("onOauthRequested", payload),
            onPing: (payload) => show("onPing", payload),
            onSelectedInstitution: (payload) => show("onSelectedInstitution", payload),
            onStepChange: (payload) => show("onStepChange", payload),
            onSubmitMFA: (payload) => show("onSubmitMFA", payload),
            onUpdateCredentials: (payload) => show("onUpdateCredentials", payload),
          })
        },
        false,
      )
    </script>
  </head>
  <body>
    <div id="widget"></div>
    <div id="output"></div>
  </body>
</html>
